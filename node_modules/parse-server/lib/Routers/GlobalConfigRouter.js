"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.GlobalConfigRouter = void 0;
var _node = _interopRequireDefault(require("parse/node"));
var _PromiseRouter = _interopRequireDefault(require("../PromiseRouter"));
var middleware = _interopRequireWildcard(require("../middlewares"));
var triggers = _interopRequireWildcard(require("../triggers"));
function _getRequireWildcardCache(e) { if ("function" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function (e) { return e ? t : r; })(e); }
function _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || "object" != typeof e && "function" != typeof e) return { default: e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if ("default" !== u && {}.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n.default = e, t && t.set(e, n), n; }
function _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }
// global_config.js

const getConfigFromParams = params => {
  const config = new _node.default.Config();
  for (const attr in params) {
    config.attributes[attr] = _node.default._decode(undefined, params[attr]);
  }
  return config;
};
class GlobalConfigRouter extends _PromiseRouter.default {
  getGlobalConfig(req) {
    return req.config.database.find('_GlobalConfig', {
      objectId: '1'
    }, {
      limit: 1
    }).then(results => {
      if (results.length != 1) {
        // If there is no config in the database - return empty config.
        return {
          response: {
            params: {}
          }
        };
      }
      const globalConfig = results[0];
      if (!req.auth.isMaster && globalConfig.masterKeyOnly !== undefined) {
        for (const param in globalConfig.params) {
          if (globalConfig.masterKeyOnly[param]) {
            delete globalConfig.params[param];
            delete globalConfig.masterKeyOnly[param];
          }
        }
      }
      return {
        response: {
          params: globalConfig.params,
          masterKeyOnly: globalConfig.masterKeyOnly
        }
      };
    });
  }
  async updateGlobalConfig(req) {
    if (req.auth.isReadOnly) {
      throw new _node.default.Error(_node.default.Error.OPERATION_FORBIDDEN, "read-only masterKey isn't allowed to update the config.");
    }
    const params = req.body.params;
    const masterKeyOnly = req.body.masterKeyOnly || {};
    // Transform in dot notation to make sure it works
    const update = Object.keys(params).reduce((acc, key) => {
      acc[`params.${key}`] = params[key];
      acc[`masterKeyOnly.${key}`] = masterKeyOnly[key] || false;
      return acc;
    }, {});
    const className = triggers.getClassName(_node.default.Config);
    const hasBeforeSaveHook = triggers.triggerExists(className, triggers.Types.beforeSave, req.config.applicationId);
    const hasAfterSaveHook = triggers.triggerExists(className, triggers.Types.afterSave, req.config.applicationId);
    let originalConfigObject;
    let updatedConfigObject;
    const configObject = new _node.default.Config();
    configObject.attributes = params;
    const results = await req.config.database.find('_GlobalConfig', {
      objectId: '1'
    }, {
      limit: 1
    });
    const isNew = results.length !== 1;
    if (!isNew && (hasBeforeSaveHook || hasAfterSaveHook)) {
      originalConfigObject = getConfigFromParams(results[0].params);
    }
    try {
      await triggers.maybeRunGlobalConfigTrigger(triggers.Types.beforeSave, req.auth, configObject, originalConfigObject, req.config, req.context);
      if (isNew) {
        await req.config.database.update('_GlobalConfig', {
          objectId: '1'
        }, update, {
          upsert: true
        }, true);
        updatedConfigObject = configObject;
      } else {
        const result = await req.config.database.update('_GlobalConfig', {
          objectId: '1'
        }, update, {}, true);
        updatedConfigObject = getConfigFromParams(result.params);
      }
      await triggers.maybeRunGlobalConfigTrigger(triggers.Types.afterSave, req.auth, updatedConfigObject, originalConfigObject, req.config, req.context);
      return {
        response: {
          result: true
        }
      };
    } catch (err) {
      const error = triggers.resolveError(err, {
        code: _node.default.Error.SCRIPT_FAILED,
        message: 'Script failed. Unknown error.'
      });
      throw error;
    }
  }
  mountRoutes() {
    this.route('GET', '/config', req => {
      return this.getGlobalConfig(req);
    });
    this.route('PUT', '/config', middleware.promiseEnforceMasterKeyAccess, req => {
      return this.updateGlobalConfig(req);
    });
  }
}
exports.GlobalConfigRouter = GlobalConfigRouter;
var _default = exports.default = GlobalConfigRouter;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbm9kZSIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX1Byb21pc2VSb3V0ZXIiLCJtaWRkbGV3YXJlIiwiX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQiLCJ0cmlnZ2VycyIsIl9nZXRSZXF1aXJlV2lsZGNhcmRDYWNoZSIsImUiLCJXZWFrTWFwIiwiciIsInQiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsImhhcyIsImdldCIsIm4iLCJfX3Byb3RvX18iLCJhIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCJ1IiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiaSIsInNldCIsImdldENvbmZpZ0Zyb21QYXJhbXMiLCJwYXJhbXMiLCJjb25maWciLCJQYXJzZSIsIkNvbmZpZyIsImF0dHIiLCJhdHRyaWJ1dGVzIiwiX2RlY29kZSIsInVuZGVmaW5lZCIsIkdsb2JhbENvbmZpZ1JvdXRlciIsIlByb21pc2VSb3V0ZXIiLCJnZXRHbG9iYWxDb25maWciLCJyZXEiLCJkYXRhYmFzZSIsImZpbmQiLCJvYmplY3RJZCIsImxpbWl0IiwidGhlbiIsInJlc3VsdHMiLCJsZW5ndGgiLCJyZXNwb25zZSIsImdsb2JhbENvbmZpZyIsImF1dGgiLCJpc01hc3RlciIsIm1hc3RlcktleU9ubHkiLCJwYXJhbSIsInVwZGF0ZUdsb2JhbENvbmZpZyIsImlzUmVhZE9ubHkiLCJFcnJvciIsIk9QRVJBVElPTl9GT1JCSURERU4iLCJib2R5IiwidXBkYXRlIiwia2V5cyIsInJlZHVjZSIsImFjYyIsImtleSIsImNsYXNzTmFtZSIsImdldENsYXNzTmFtZSIsImhhc0JlZm9yZVNhdmVIb29rIiwidHJpZ2dlckV4aXN0cyIsIlR5cGVzIiwiYmVmb3JlU2F2ZSIsImFwcGxpY2F0aW9uSWQiLCJoYXNBZnRlclNhdmVIb29rIiwiYWZ0ZXJTYXZlIiwib3JpZ2luYWxDb25maWdPYmplY3QiLCJ1cGRhdGVkQ29uZmlnT2JqZWN0IiwiY29uZmlnT2JqZWN0IiwiaXNOZXciLCJtYXliZVJ1bkdsb2JhbENvbmZpZ1RyaWdnZXIiLCJjb250ZXh0IiwidXBzZXJ0IiwicmVzdWx0IiwiZXJyIiwiZXJyb3IiLCJyZXNvbHZlRXJyb3IiLCJjb2RlIiwiU0NSSVBUX0ZBSUxFRCIsIm1lc3NhZ2UiLCJtb3VudFJvdXRlcyIsInJvdXRlIiwicHJvbWlzZUVuZm9yY2VNYXN0ZXJLZXlBY2Nlc3MiLCJleHBvcnRzIiwiX2RlZmF1bHQiXSwic291cmNlcyI6WyIuLi8uLi9zcmMvUm91dGVycy9HbG9iYWxDb25maWdSb3V0ZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gZ2xvYmFsX2NvbmZpZy5qc1xuaW1wb3J0IFBhcnNlIGZyb20gJ3BhcnNlL25vZGUnO1xuaW1wb3J0IFByb21pc2VSb3V0ZXIgZnJvbSAnLi4vUHJvbWlzZVJvdXRlcic7XG5pbXBvcnQgKiBhcyBtaWRkbGV3YXJlIGZyb20gJy4uL21pZGRsZXdhcmVzJztcbmltcG9ydCAqIGFzIHRyaWdnZXJzIGZyb20gJy4uL3RyaWdnZXJzJztcblxuY29uc3QgZ2V0Q29uZmlnRnJvbVBhcmFtcyA9IHBhcmFtcyA9PiB7XG4gIGNvbnN0IGNvbmZpZyA9IG5ldyBQYXJzZS5Db25maWcoKTtcbiAgZm9yIChjb25zdCBhdHRyIGluIHBhcmFtcykge1xuICAgIGNvbmZpZy5hdHRyaWJ1dGVzW2F0dHJdID0gUGFyc2UuX2RlY29kZSh1bmRlZmluZWQsIHBhcmFtc1thdHRyXSk7XG4gIH1cbiAgcmV0dXJuIGNvbmZpZztcbn07XG5cbmV4cG9ydCBjbGFzcyBHbG9iYWxDb25maWdSb3V0ZXIgZXh0ZW5kcyBQcm9taXNlUm91dGVyIHtcbiAgZ2V0R2xvYmFsQ29uZmlnKHJlcSkge1xuICAgIHJldHVybiByZXEuY29uZmlnLmRhdGFiYXNlXG4gICAgICAuZmluZCgnX0dsb2JhbENvbmZpZycsIHsgb2JqZWN0SWQ6ICcxJyB9LCB7IGxpbWl0OiAxIH0pXG4gICAgICAudGhlbihyZXN1bHRzID0+IHtcbiAgICAgICAgaWYgKHJlc3VsdHMubGVuZ3RoICE9IDEpIHtcbiAgICAgICAgICAvLyBJZiB0aGVyZSBpcyBubyBjb25maWcgaW4gdGhlIGRhdGFiYXNlIC0gcmV0dXJuIGVtcHR5IGNvbmZpZy5cbiAgICAgICAgICByZXR1cm4geyByZXNwb25zZTogeyBwYXJhbXM6IHt9IH0gfTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBnbG9iYWxDb25maWcgPSByZXN1bHRzWzBdO1xuICAgICAgICBpZiAoIXJlcS5hdXRoLmlzTWFzdGVyICYmIGdsb2JhbENvbmZpZy5tYXN0ZXJLZXlPbmx5ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICBmb3IgKGNvbnN0IHBhcmFtIGluIGdsb2JhbENvbmZpZy5wYXJhbXMpIHtcbiAgICAgICAgICAgIGlmIChnbG9iYWxDb25maWcubWFzdGVyS2V5T25seVtwYXJhbV0pIHtcbiAgICAgICAgICAgICAgZGVsZXRlIGdsb2JhbENvbmZpZy5wYXJhbXNbcGFyYW1dO1xuICAgICAgICAgICAgICBkZWxldGUgZ2xvYmFsQ29uZmlnLm1hc3RlcktleU9ubHlbcGFyYW1dO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHJlc3BvbnNlOiB7XG4gICAgICAgICAgICBwYXJhbXM6IGdsb2JhbENvbmZpZy5wYXJhbXMsXG4gICAgICAgICAgICBtYXN0ZXJLZXlPbmx5OiBnbG9iYWxDb25maWcubWFzdGVyS2V5T25seSxcbiAgICAgICAgICB9LFxuICAgICAgICB9O1xuICAgICAgfSk7XG4gIH1cblxuICBhc3luYyB1cGRhdGVHbG9iYWxDb25maWcocmVxKSB7XG4gICAgaWYgKHJlcS5hdXRoLmlzUmVhZE9ubHkpIHtcbiAgICAgIHRocm93IG5ldyBQYXJzZS5FcnJvcihcbiAgICAgICAgUGFyc2UuRXJyb3IuT1BFUkFUSU9OX0ZPUkJJRERFTixcbiAgICAgICAgXCJyZWFkLW9ubHkgbWFzdGVyS2V5IGlzbid0IGFsbG93ZWQgdG8gdXBkYXRlIHRoZSBjb25maWcuXCJcbiAgICAgICk7XG4gICAgfVxuICAgIGNvbnN0IHBhcmFtcyA9IHJlcS5ib2R5LnBhcmFtcztcbiAgICBjb25zdCBtYXN0ZXJLZXlPbmx5ID0gcmVxLmJvZHkubWFzdGVyS2V5T25seSB8fCB7fTtcbiAgICAvLyBUcmFuc2Zvcm0gaW4gZG90IG5vdGF0aW9uIHRvIG1ha2Ugc3VyZSBpdCB3b3Jrc1xuICAgIGNvbnN0IHVwZGF0ZSA9IE9iamVjdC5rZXlzKHBhcmFtcykucmVkdWNlKChhY2MsIGtleSkgPT4ge1xuICAgICAgYWNjW2BwYXJhbXMuJHtrZXl9YF0gPSBwYXJhbXNba2V5XTtcbiAgICAgIGFjY1tgbWFzdGVyS2V5T25seS4ke2tleX1gXSA9IG1hc3RlcktleU9ubHlba2V5XSB8fCBmYWxzZTtcbiAgICAgIHJldHVybiBhY2M7XG4gICAgfSwge30pO1xuICAgIGNvbnN0IGNsYXNzTmFtZSA9IHRyaWdnZXJzLmdldENsYXNzTmFtZShQYXJzZS5Db25maWcpO1xuICAgIGNvbnN0IGhhc0JlZm9yZVNhdmVIb29rID0gdHJpZ2dlcnMudHJpZ2dlckV4aXN0cyhjbGFzc05hbWUsIHRyaWdnZXJzLlR5cGVzLmJlZm9yZVNhdmUsIHJlcS5jb25maWcuYXBwbGljYXRpb25JZCk7XG4gICAgY29uc3QgaGFzQWZ0ZXJTYXZlSG9vayA9IHRyaWdnZXJzLnRyaWdnZXJFeGlzdHMoY2xhc3NOYW1lLCB0cmlnZ2Vycy5UeXBlcy5hZnRlclNhdmUsIHJlcS5jb25maWcuYXBwbGljYXRpb25JZCk7XG4gICAgbGV0IG9yaWdpbmFsQ29uZmlnT2JqZWN0O1xuICAgIGxldCB1cGRhdGVkQ29uZmlnT2JqZWN0O1xuICAgIGNvbnN0IGNvbmZpZ09iamVjdCA9IG5ldyBQYXJzZS5Db25maWcoKTtcbiAgICBjb25maWdPYmplY3QuYXR0cmlidXRlcyA9IHBhcmFtcztcblxuICAgIGNvbnN0IHJlc3VsdHMgPSBhd2FpdCByZXEuY29uZmlnLmRhdGFiYXNlLmZpbmQoJ19HbG9iYWxDb25maWcnLCB7IG9iamVjdElkOiAnMScgfSwgeyBsaW1pdDogMSB9KTtcbiAgICBjb25zdCBpc05ldyA9IHJlc3VsdHMubGVuZ3RoICE9PSAxO1xuICAgIGlmICghaXNOZXcgJiYgKGhhc0JlZm9yZVNhdmVIb29rIHx8IGhhc0FmdGVyU2F2ZUhvb2spKSB7XG4gICAgICBvcmlnaW5hbENvbmZpZ09iamVjdCA9IGdldENvbmZpZ0Zyb21QYXJhbXMocmVzdWx0c1swXS5wYXJhbXMpO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgYXdhaXQgdHJpZ2dlcnMubWF5YmVSdW5HbG9iYWxDb25maWdUcmlnZ2VyKHRyaWdnZXJzLlR5cGVzLmJlZm9yZVNhdmUsIHJlcS5hdXRoLCBjb25maWdPYmplY3QsIG9yaWdpbmFsQ29uZmlnT2JqZWN0LCByZXEuY29uZmlnLCByZXEuY29udGV4dCk7XG4gICAgICBpZiAoaXNOZXcpIHtcbiAgICAgICAgYXdhaXQgcmVxLmNvbmZpZy5kYXRhYmFzZS51cGRhdGUoJ19HbG9iYWxDb25maWcnLCB7IG9iamVjdElkOiAnMScgfSwgdXBkYXRlLCB7IHVwc2VydDogdHJ1ZSB9LCB0cnVlKVxuICAgICAgICB1cGRhdGVkQ29uZmlnT2JqZWN0ID0gY29uZmlnT2JqZWN0O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmVxLmNvbmZpZy5kYXRhYmFzZS51cGRhdGUoJ19HbG9iYWxDb25maWcnLCB7IG9iamVjdElkOiAnMScgfSwgdXBkYXRlLCB7fSwgdHJ1ZSk7XG4gICAgICAgIHVwZGF0ZWRDb25maWdPYmplY3QgPSBnZXRDb25maWdGcm9tUGFyYW1zKHJlc3VsdC5wYXJhbXMpO1xuICAgICAgfVxuICAgICAgYXdhaXQgdHJpZ2dlcnMubWF5YmVSdW5HbG9iYWxDb25maWdUcmlnZ2VyKHRyaWdnZXJzLlR5cGVzLmFmdGVyU2F2ZSwgcmVxLmF1dGgsIHVwZGF0ZWRDb25maWdPYmplY3QsIG9yaWdpbmFsQ29uZmlnT2JqZWN0LCByZXEuY29uZmlnLCByZXEuY29udGV4dCk7XG4gICAgICByZXR1cm4geyByZXNwb25zZTogeyByZXN1bHQ6IHRydWUgfSB9XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBjb25zdCBlcnJvciA9IHRyaWdnZXJzLnJlc29sdmVFcnJvcihlcnIsIHtcbiAgICAgICAgY29kZTogUGFyc2UuRXJyb3IuU0NSSVBUX0ZBSUxFRCxcbiAgICAgICAgbWVzc2FnZTogJ1NjcmlwdCBmYWlsZWQuIFVua25vd24gZXJyb3IuJyxcbiAgICAgIH0pO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgbW91bnRSb3V0ZXMoKSB7XG4gICAgdGhpcy5yb3V0ZSgnR0VUJywgJy9jb25maWcnLCByZXEgPT4ge1xuICAgICAgcmV0dXJuIHRoaXMuZ2V0R2xvYmFsQ29uZmlnKHJlcSk7XG4gICAgfSk7XG4gICAgdGhpcy5yb3V0ZSgnUFVUJywgJy9jb25maWcnLCBtaWRkbGV3YXJlLnByb21pc2VFbmZvcmNlTWFzdGVyS2V5QWNjZXNzLCByZXEgPT4ge1xuICAgICAgcmV0dXJuIHRoaXMudXBkYXRlR2xvYmFsQ29uZmlnKHJlcSk7XG4gICAgfSk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgR2xvYmFsQ29uZmlnUm91dGVyO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFDQSxJQUFBQSxLQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxjQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRSxVQUFBLEdBQUFDLHVCQUFBLENBQUFILE9BQUE7QUFDQSxJQUFBSSxRQUFBLEdBQUFELHVCQUFBLENBQUFILE9BQUE7QUFBd0MsU0FBQUsseUJBQUFDLENBQUEsNkJBQUFDLE9BQUEsbUJBQUFDLENBQUEsT0FBQUQsT0FBQSxJQUFBRSxDQUFBLE9BQUFGLE9BQUEsWUFBQUYsd0JBQUEsWUFBQUEsQ0FBQUMsQ0FBQSxXQUFBQSxDQUFBLEdBQUFHLENBQUEsR0FBQUQsQ0FBQSxL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RUFBRTtRQUFLLENBQUMsRUFBRSxJQUFJLENBQUM7UUFDcEdMLG1CQUFtQixHQUFHQyxZQUFZO01BQ3BDLENBQUMsTUFBTTtRQUNMLE1BQU1LLE1BQU0sR0FBRyxNQUFNeEMsR0FBRyxDQUFDVixNQUFNLENBQUNXLFFBQVEsQ0FBQ2tCLE1BQU0sQ0FBQyxlQUFlLEVBQUU7VUFBRWhCLFFBQVEsRUFBRTtRQUFJLENBQUMsRUFBRWdCLE1BQU0sRUFBRSxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUM7UUFDckdlLG1CQUFtQixHQUFHOUMsbUJBQW1CLENBQUNvRCxNQUFNLENBQUNuRCxNQUFNLENBQUM7TUFDMUQ7TUFDQSxNQUFNdEIsUUFBUSxDQUFDc0UsMkJBQTJCLENBQUN0RSxRQUFRLENBQUM2RCxLQUFLLENBQUNJLFNBQVMsRUFBRWhDLEdBQUcsQ0FBQ1UsSUFBSSxFQUFFd0IsbUJBQW1CLEVBQUVELG9CQUFvQixFQUFFakMsR0FBRyxDQUFDVixNQUFNLEVBQUVVLEdBQUcsQ0FBQ3NDLE9BQU8sQ0FBQztNQUNsSixPQUFPO1FBQUU5QixRQUFRLEVBQUU7VUFBRWdDLE1BQU0sRUFBRTtRQUFLO01BQUUsQ0FBQztJQUN2QyxDQUFDLENBQUMsT0FBT0MsR0FBRyxFQUFFO01BQ1osTUFBTUMsS0FBSyxHQUFHM0UsUUFBUSxDQUFDNEUsWUFBWSxDQUFDRixHQUFHLEVBQUU7UUFDdkNHLElBQUksRUFBRXJELGFBQUssQ0FBQ3lCLEtBQUssQ0FBQzZCLGFBQWE7UUFDL0JDLE9BQU8sRUFBRTtNQUNYLENBQUMsQ0FBQztNQUNGLE1BQU1KLEtBQUs7SUFDYjtFQUNGO0VBRUFLLFdBQVdBLENBQUEsRUFBRztJQUNaLElBQUksQ0FBQ0MsS0FBSyxDQUFDLEtBQUssRUFBRSxTQUFTLEVBQUVoRCxHQUFHLElBQUk7TUFDbEMsT0FBTyxJQUFJLENBQUNELGVBQWUsQ0FBQ0MsR0FBRyxDQUFDO0lBQ2xDLENBQUMsQ0FBQztJQUNGLElBQUksQ0FBQ2dELEtBQUssQ0FBQyxLQUFLLEVBQUUsU0FBUyxFQUFFbkYsVUFBVSxDQUFDb0YsNkJBQTZCLEVBQUVqRCxHQUFHLElBQUk7TUFDNUUsT0FBTyxJQUFJLENBQUNjLGtCQUFrQixDQUFDZCxHQUFHLENBQUM7SUFDckMsQ0FBQyxDQUFDO0VBQ0o7QUFDRjtBQUFDa0QsT0FBQSxDQUFBckQsa0JBQUEsR0FBQUEsa0JBQUE7QUFBQSxJQUFBc0QsUUFBQSxHQUFBRCxPQUFBLENBQUE1RSxPQUFBLEdBRWN1QixrQkFBa0IiLCJpZ25vcmVMaXN0IjpbXX0=